# Playbook для настройки инфраструктуры

Ansible Playbook предназначен для автоматической подготовки и настройки серверов и установки Python, ClickHouse, Vector, Nginx и Lighthouse на различные хосты, а также их настройку.

## Описание Playbook

Playbook состоит из блоков задач, выполняемых на разных хостах:

1. **Подготовка виртуальных машин для работы с Ansible** — устанавливается Python 3.
2. **Установка ClickHouse** — устанавливаются зависимости, добавляется репозиторий, устанавливается сам ClickHouse и создается база данных `logs`.
3. **Установка и конфигурация Vector** — устанавливается Vector, и применяется конфигурационный файл из шаблона.
4. **Установка и настройка Nginx** — устанавливается и настраивается Nginx, применяется конфигурация.
5. **Установка Lighthouse** — клонируется репозиторий Lighthouse, добавляется его директория в список безопасных для Git и устанавливаются необходимые права доступа.

## Параметры

Параметры на уровне хостов:

- **hosts: all** — задача выполняется на всех хостах.
- **hosts: clickhouse** — задачи выполняются на хостах с меткой `clickhouse`.
- **hosts: vector** — задачи выполняются на хостах с меткой `vector`.
- **hosts: lighthouse** — задачи выполняются на хостах с меткой `lighthouse`.

**Параметры для задач:**
- **become: true** — задачи выполняются с правами суперпользователя.
- **state: present** — пакеты и сервисы устанавливаются или запускаются.
- **update_cache: true** — обновление кэша пакетов перед установкой.



## Требования
Для корректной работы Playbook необходимо наличие:
Ansible 2.18.4 или выше.
Виртуальные машины ubuntu 24.04


## Как запустить
Склонируйте репозиторий с playbook на свою машину.
Настройте инвентаризационный файл .inventory.yml с перечнем хостов.
Запустите playbook с помощью команды:
ansible-playbook -i inventory.yml site.yml